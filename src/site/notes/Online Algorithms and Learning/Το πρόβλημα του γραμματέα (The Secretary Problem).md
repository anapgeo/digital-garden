---
{"dg-publish":true,"permalink":"/online-algorithms-and-learning/to-provlima-toy-grammatea-the-secretary-problem/","created":"2025-03-25T14:58:23.070+02:00","updated":"2025-03-25T15:00:08.447+02:00"}
---

Στο πρόβλημα του γραμματέα, έχουμε(όπως και στις [[Online Algorithms and Learning/Ανισότητες Προφητών(Prophet Inequalities)\|Ανισότητες Προφητών(Prophet Inequalities)]]) κάποια κουτιά διαθέσιμα τα οποία περιέχουν κάποιες αξίες. Γνωρίζουμε τον αριθμό των κουτιών αλλά δεν γνωρίζουμε τίποτα για τις τιμές που ενδέχεται να περιέχουν (σε αντίθεση με τα prophet inequalities όπου γνωρίζαμε κάποια πληροφορία για τις αξίες των κουτιών αλλά μας ήταν αδιάφορος ο αριθμός τους).

Τα κουτιά μας παρουσιάζονται σταδιακά ένα-ένα. Τη χρονική στιγμή t ας πούμε πως δεχόμαστε ένα κουτί με αξία $ν_t$. Κάθε φορά που δεχόμαστε ένα κουτί, βλέπουμε την αξία του και μπορούμε είτε να το κρατήσουμε και να πάρουμε την αξία αυτή είτε να το απορρίψουμε αναμένοντας ότι στα επόμενα μπορεί η τύχη μας να είναι καλύτερη.

Θα προσπαθήσουμε να κατασκευάσουμε μια στρατηγική(stopping rule), ώστε να μεγιστοποιούμαι την πιθανότητα να επιλέξουμε το αντικείμενο με τη μεγαλύτερη αξία.


## Warm Up

Θα δοκιμάσουμε πρώτα μια απλή στρατηγική για την οποία δεν ισχυριζόμαστε πως είναι βέλτιστη. Η στρατηγική έχει ως εξής:

- Αξιολογούμε και απορρίπτουμε τα πρώτα $n/2$ αντικείμενα κρατώντας την μεγαλύτερη αξία που συναντήσαμε, έστω $ν_{n/2}^*$
- Στη συνέχεια επιλέγουμε το πρώτο κουτί από τα εναπομείναντα $n/2$ αντικείμενα το οποίο έχει αξία μεγαλύτερη από $ν_{n/2}^*$

Πόσο καλά αναμένουμε να τα πάει ο αλγόριθμος αυτός; Ας εξετάσουμε την πιθανότητα να επιλέξουμε το καλύτερο αντικείμενο:

Για να είμαστε σίγουροι ότι θα επιλέξουμε τη μεγαλύτερη αξία, θα πρέπει να συμβούν 2 συμβάντα:

- Συμβάν Α: “Το δεύτερο καλύτερο αντικείμενο βρίσκεται στις πρώτες $n/2$ θέσεις” -> $Pr[A]=1/2$
- Συμβάν Β: “Το καλύτερο αντικείμενο βρίσκεται στις θέσεις $[n/2+1,…,n]$” -> $Pr[B|A] \geq 1/2$

Ισχύει ότι $Pr[AB]=Pr[B|A]Pr[A]\geq 1/4$

Επομένως η πιθανότητα να επιλέξουμε το κουτί με τη μεγαλύτερη αξία είναι τουλάχιστον 25%


## Βέλτιστη Στρατηγική


## Σκεπτικό εύρεσης βέλτιστης στρατηγικής 

Καθώς προχωράμε στην εύρεση της βέλτιστης στρατηγικής ας σκεφτούμε το εξής: 

Ποιά η πιθανότητα το βέλτιστο κουτί να είναι το i-οστό, δεδομένου ότι είναι το καλύτερο(να έχει τη μεγαλύτερη αξία) που έχουμε δεί μέχρι στιγμής;

Η πιθανότητα γενικά το i-οστό κουτί να είναι το καθολικά το καλύτερο είναι προφανώς $1/n$, όπου $n$ το πλήθος των κουτιών, καθώς όλα τα κουτιά είναι ισοπίθανο να είναι τα καλύτερα. Ας το ονομάσουμε αυτό συμβάν Γ με $Pr[Γ]=1/n$

Η πιθανότητα το i-οστό κουτί να είναι το καλύτερο που έχουμε δει μέχρι στιγμής είναι $1/i$, όπου $i$ το πλήθος των κουτιών που εξετάζουμε, καθώς όλα τα κουτιά είναι ισοπίθανο να είναι τα καλύτερα. Ας το ονομάσουμε αυτό συμβάν Δ με $Pr[Δ]=1/i$

Αρα η πιθανότητα έστω $f(i)$ που ψάχνουμε έιναι $f(i)=\frac{Pr[Γ]}{Pr[Δ]}=\frac{i}{n}$



Έστω τώρα πως κατασκευάζουμε μια στρατηγική όπως αυτή που παρουσιάσαμε στο warmup. 'Εστω επίσης $g(i)$ η πιθανότητα να επιλέξουμε το καλύτερο αντικείμενο στα αντικείμενα $i,..,n$ χρησιμοποιώντας τη βέλτιστη στρατηγική. Παρατηρούμε πως $g(i)\geq g(i+1)$, διότι μπορούμε να επιλέξουμε να απορρίψουμε το αντικείμενο i και να προχωρήσουμε στα παρακάτω.

Κάθε βέλτιστη στρατηγική θα πρέπει να ακολουθεί τον εξής κανόνα:

- Να απορρίπτει ένα αντικείμενο i αν $f(i)<g(i+1)$(δηλαδή αν η πιθανότητα χρησιμοποιώντας τη βέλτιστη στρατηγική να βρεί το καλύτερο κουτί στα κουτιά που ακολουθούν το i είναι μεγαλύτερη από την πιθανότητα το ίδιο το i να είναι το βέλτιστο κουτί καθολικά αν είναι το καλύτερο που έχουμε δει μέχρι τώρα)
- Αν όμως $f(i)\geq g(i+1)$ τότε θα πρέπει να αποδέχεται το $i$, αν το $i$ είναι το καλύτερο κουτί που έχει δει μέχρι στιγμής.

> Σημείωση: Πιο πρακτικά, για να καταλάβουμε τον παραπάνω κανόνα, ορίζουμε το μέχρι πότε θα απορρίπτουμε αντικείμενα εως ότου είμαστε αρκετά σίγουροι(με πιθανότητα) πως το αντικείμενο που θα επιλέξουμε αν είναι το καλύτερο που έχουμε δει μέχρι τώρα είναι και το καλύτερο καθολικά. Σκεφτείτε πως το $f(i)$ είναι μια αύξουσα συνάρτηση ώς προς $i$, δηλαδή η πιθανότητα το αντικείμενο $i$ που ανοίγουμε αν είναι το καλύτερο που έχουμε δει μέχρι στιγμής να είναι το καθολικά καλύτερο αυξάνεται καθώς περνάμε αντικείμενα. Αντίστοιχα η πιθανότητα $g(i)$ να βρούμε το καλύτερο κουτί από το κουτί $i$ και πέρα μικραίνει καθώς το $i$ μεγαλώνει ανεξάρτητα από την στρατηγική που ακολουθούμε. Όταν η $f(i)$ φτάσει η ξεπεράσει την $g(i+1)$ τότε επιλέγουμε το πρώτο αντικείμενο που θα ξεπεράσει τις αξίες που έχουμε δει έως εκείνη τη στιγμή.


### Η βέλτιστη λύση

>**Θεώρημα**: Υπάρχει στρατηγική που επιτυγχάνει να επιλέξει το καθολικά βέλτιστο αντικείμενο με πιθανότητα μεγαλύτερη ίση του $1/e ≈ 36.8% $ 

Απόδειξη

Ορίζουμε τον κανόνα $N_τ$ σύμφωνα με τον οποίο απορρίπτουμε τα πρώτα $τ$ αντικείμενα και επιλέγουμε στη συνέχεια από τα κουτιά που απέμειναν το πρώτο κουτί που θα είναι καλύτερο από κάθε κουτί που έχουμε δει ως τη στιγμή εκείνη.

Ορίζουμε 2 πιθανά συμβάντα:
1. $Α_k$:  το k-οστό αντικείμενο είναι το καθολικά καλύτερο 
2. $B_k$:  το k-οστό αντικείμενο επιλέγεται 

Πάμε να δούμε ποια θα είναι η πιθανότητα επιτυχίας $P$ του $N_τ$:

$$
P = \sum_{k=τ+1}^n Pr[A_kB_k]= \sum_{k=τ+1}^n Pr[A_k]\cdot Pr[B_k|A_k]=\frac{1}{n}\sum_{k=τ+1}^n Pr[B_k|A_k]= \frac{1}{n}\sum_{k=τ+1}^n Pr[\text{το καλύτερο από τα πρώτα k − 1 εμφανίζεται στις πρώτες τ θέσεις}]
$$

Γνωρίζουμε ότι $Pr[\text{το καλύτερο από τα πρώτα k − 1 εμφανίζεται στις πρώτες τ θέσεις}]= \frac{τ}{k-1}$ άρα για την πιθανότητα επιτυχίας $P$ έχουμε:

$$
P = \frac{1}{n}\sum_{k=τ+1}^n \frac{τ}{k-1}= \frac{τ}{n}\sum_{k=τ+1}^n \frac{1}{k-1}=  \frac{τ}{n} (H_{n−1} − H_{τ−1})=g(τ+1)
$$

> Σημείωση: 
> - $Pr[B_k|A_k]$= η πιθανότητα το $k$-οστό στοιχείο να επιλεγέι δεδομένου ότι είναι το καθολικά καλύτερο.
> - Η πιθανότητα αυτή ισούται με την πιθανότητα όλα το καλύτερο από τα $k-1$ κουτιά να βρίσκεται στις πρώτες $τ$ θέσεις. Διαφορετικά κάποιο στοιχείο που βρίσκεται στις θέσεις $τ,...,k-1$ θα επιλεγεί πριν φτάσουμε στο $k$-οστό.
> - Η πιθανότητα $P$ που υπολογίσαμε ισούται με την πιθανότητα να επιλέξουμε το βέλτιστο κουτί από τα κουτιά  που βρίσκονται στις θέσεις $(τ+1),...,n$, ακολουθώντας την στρατηγική που περιγράψαμε παραπάνω


Επομένως έχουμε $g(τ+1)= \frac{τ}{n} (H_{n−1} − H_{τ−1})$ και $f(τ)=\frac{τ}{n}$

Αναζητούμε  την πρώτη θέση για την οποία $f(τ)\geq g(τ+1)$, το οποίο $τ$ θα θέσουμε και ως κατώφλι. Η θέση αυτή είναι το μικρότερο δυνατό $τ$ για το οποίο $(H_{n−1} − H_{τ−1})\leq 1$ δηλαδή:
$$
\min_τ\{\frac{1}{τ}+\frac{1}{τ+1}+...+\frac{1}{n}\leq 1 \}
$$

Για μεγάλες τιμές του $n$ ισχύει: 

$$
\sum_{k=τ+1}^{n}1/k≈ \ln(n/τ)
$$ 

επομένως σε αυτή την περίπτωση το βέλτιστο $τ$ είναι: $τ≈n/e$ 

Η αντίστοιχη πιθανότητα επιτυχίας είναι: $g(τ+1) ≈ 1/e ≈ 0.367$ 


> Σημείωση: Για κάποιες μικρές τιμές του n μπορείτε να δείτε τα αποτέλεσματα στον παρακάτω πίνακα ![Screenshot_1.png](/img/user/Online%20Algorithms%20and%20Learning/Screenshot_1.png)